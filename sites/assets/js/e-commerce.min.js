!function(){"use strict";erpnext.ProductView=class{constructor(t){Object.assign(this,t),this.preference=this.view_type,this.make()}make(t){void 0===t&&(t=!1),this.products_section.empty(),this.prepare_toolbar(),this.get_item_filter_data(t)}prepare_toolbar(){this.products_section.append('\n\t\t\t<div class="toolbar d-flex">\n\t\t\t</div>\n\t\t'),this.prepare_search(),this.prepare_view_toggler(),frappe.require("/assets/js/e-commerce.min.js",function(){new erpnext.ProductSearch})}prepare_view_toggler(){$("#list").length&&$("#image-view").length||(this.render_view_toggler(),this.bind_view_toggler_actions(),this.set_view_state())}get_item_filter_data(t){void 0===t&&(t=!1);var e=this;this.from_filters=t;var i=this.get_query_filters();this.disable_view_toggler(!0),frappe.call({method:"erpnext.e_commerce.api.get_product_filter_data",args:{query_args:i},callback:function(i){!i||i.exc||!i.message||i.message.exc?e.render_no_products_section(!0):(e.item_group&&i.message.sub_categories.length&&e.render_item_sub_categories(i.message.sub_categories),i.message.items.length?(e.re_render_discount_filters(i.message.filters.discount_filters),e.render_list_view(i.message.items,i.message.settings),e.render_grid_view(i.message.items,i.message.settings),e.products=i.message.items,e.product_count=i.message.items_count):e.render_no_products_section(),t||(e.bind_filters(),e.restore_filters_state()),e.add_paging_section(i.message.settings)),e.disable_view_toggler(!1)}})}disable_view_toggler(t){void 0===t&&(t=!1),$("#list").prop("disabled",t),$("#image-view").prop("disabled",t)}render_grid_view(t,e){var i=this;this.prepare_product_area_wrapper("grid"),frappe.require("/assets/js/e-commerce.min.js",function(){new erpnext.ProductGrid({items:t,products_section:$("#products-grid-area"),settings:e,preference:i.preference})})}render_list_view(t,e){var i=this;this.prepare_product_area_wrapper("list"),frappe.require("/assets/js/e-commerce.min.js",function(){new erpnext.ProductList({items:t,products_section:$("#products-list-area"),settings:e,preference:i.preference})})}prepare_product_area_wrapper(t){var e="list"==t?"ml-2":"",i="list"==t?"mt-6":"mt-minus-1";return this.products_section.append('\n\t\t\t<br>\n\t\t\t<div id="products-'+t+'-area" class="row products-list '+i+" "+e+'"></div>\n\t\t')}get_query_filters(){var t=frappe.utils.get_query_params(),e=t.field_filters,i=t.attribute_filters;return{field_filters:e=e?JSON.parse(e):{},attribute_filters:i=i?JSON.parse(i):{},item_group:this.item_group,start:t.start||null,from_filters:this.from_filters||!1}}add_paging_section(t){if($(".product-paging-area").remove(),this.products){var e='\n\t\t\t\t<div class="row product-paging-area mt-5">\n\t\t\t\t\t<div class="col-3">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-9 text-right">\n\t\t\t',i=frappe.utils.get_query_params(),s=i.start?cint(JSON.parse(i.start)):0,r=t.products_per_page||0,n=s>0?"":"disabled",a=this.product_count>r?"":"disabled";e+='\n\t\t\t\t<button class="btn btn-default btn-prev" data-start="'+(s-r)+'"\n\t\t\t\t\tstyle="float: left" '+n+">\n\t\t\t\t\t"+__("Prev")+"\n\t\t\t\t</button>",e+='\n\t\t\t\t<button class="btn btn-default btn-next" data-start="'+(s+r)+'"\n\t\t\t\t\t'+a+">\n\t\t\t\t\t"+__("Next")+"\n\t\t\t\t</button>\n\t\t\t",e+="</div></div>",$(".page_content").append(e),this.bind_paging_action()}}prepare_search(){$(".toolbar").append('\n\t\t\t<div class="input-group col-8 p-0">\n\t\t\t\t<div class="dropdown w-100" id="dropdownMenuSearch">\n\t\t\t\t\t<input type="search" name="query" id="search-box" class="form-control font-md"\n\t\t\t\t\t\tplaceholder="Search for Products"\n\t\t\t\t\t\taria-label="Product" aria-describedby="button-addon2">\n\t\t\t\t\t<div class="search-icon">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"\n\t\t\t\t\t\t\tfill="none"\n\t\t\t\t\t\t\tstroke="currentColor" stroke-width="2" stroke-linecap="round"\n\t\t\t\t\t\t\tstroke-linejoin="round"\n\t\t\t\t\t\t\tclass="feather feather-search">\n\t\t\t\t\t\t\t<circle cx="11" cy="11" r="8"></circle>\n\t\t\t\t\t\t\t<line x1="21" y1="21" x2="16.65" y2="16.65"></line>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!-- Results dropdown rendered in product_search.js --\x3e\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t')}render_view_toggler(){$(".toolbar").append('<div class="toggle-container col-4 p-0"></div>'),["btn-list-view","btn-grid-view"].forEach(function(t){var e="btn-list-view"===t?"list":"image-view";$(".toggle-container").append('\n\t\t\t\t<div class="form-group mb-0" id="toggle-view">\n\t\t\t\t\t<button id="'+e+'" class="btn '+t+' mr-2">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<svg class="icon icon-md">\n\t\t\t\t\t\t\t\t<use href="#icon-'+e+'"></use>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t')})}bind_view_toggler_actions(){$("#list").click(function(){var t=$(this);t.removeClass("btn-primary"),t.addClass("btn-primary"),$(".btn-grid-view").removeClass("btn-primary"),$("#products-grid-area").addClass("hidden"),$("#products-list-area").removeClass("hidden"),localStorage.setItem("product_view","List View")}),$("#image-view").click(function(){var t=$(this);t.removeClass("btn-primary"),t.addClass("btn-primary"),$(".btn-list-view").removeClass("btn-primary"),$("#products-list-area").addClass("hidden"),$("#products-grid-area").removeClass("hidden"),localStorage.setItem("product_view","Grid View")})}set_view_state(){"List View"===this.preference?($("#list").addClass("btn-primary"),$("#image-view").removeClass("btn-primary")):($("#image-view").addClass("btn-primary"),$("#list").removeClass("btn-primary"))}bind_paging_action(){var t=this;$(".btn-prev, .btn-next").click(function(e){var i=$(e.target);t.from_filters=!1,i.prop("disabled",!0);var s=i.data("start"),r=frappe.utils.get_query_params();r.start=s;var n=window.location.pathname+"?"+frappe.utils.get_url_from_dict(r);window.location.href=n})}re_render_discount_filters(t){this.get_discount_filter_html(t),this.from_filters&&this.bind_discount_filter_action(),this.restore_discount_filter()}get_discount_filter_html(t){if($("#discount-filters").remove(),t){$("#product-filters").append('\n\t\t\t\t<div id="discount-filters" class="mb-4 filter-block pb-5">\n\t\t\t\t\t<div class="filter-label mb-3">'+__("Discounts")+"</div>\n\t\t\t\t</div>\n\t\t\t");var e='<div class="filter-options">';t.forEach(function(t){e+='\n\t\t\t\t\t<div class="checkbox">\n\t\t\t\t\t\t<label data-value="'+t[0]+'">\n\t\t\t\t\t\t\t<input type="radio"\n\t\t\t\t\t\t\t\tclass="product-filter discount-filter"\n\t\t\t\t\t\t\t\tname="discount" id="'+t[0]+'"\n\t\t\t\t\t\t\t\tdata-filter-name="discount"\n\t\t\t\t\t\t\t\tdata-filter-value="'+t[0]+'"\n\t\t\t\t\t\t\t\tstyle="width: 14px !important"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class="label-area" for="'+t[0]+'">\n\t\t\t\t\t\t\t\t\t'+t[1]+"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t"}),e+="</div>",$("#discount-filters").append(e)}}restore_discount_filter(){var t=frappe.utils.get_query_params().field_filters;if(t&&(t=JSON.parse(t))&&t.discount){var e=t.discount.map(function(t){return'input[data-filter-name="discount"][data-filter-value="'+t+'"]'}).join(",");$(e).prop("checked",!0),this.field_filters=t}}bind_discount_filter_action(){var t=this,e=this;$(".discount-filter").on("change",function(i){var s=$(i.target),r=s.is(":checked"),n=s.data().filterValue;delete t.field_filters.discount,r&&(t.field_filters.discount=[],t.field_filters.discount.push(n)),0===t.field_filters.discount.length&&delete t.field_filters.discount,e.change_route_with_filters()})}bind_filters(){var t=this,e=this;this.field_filters={},this.attribute_filters={},$(".product-filter").on("change",function(i){e.from_filters=!0;var s=$(i.target),r=s.is(":checked");if(s.is(".attribute-filter")){var n=s.data(),a=n.attributeName,o=n.attributeValue;r?(t.attribute_filters[a]=t.attribute_filters[a]||[],t.attribute_filters[a].push(o)):(t.attribute_filters[a]=t.attribute_filters[a]||[],t.attribute_filters[a]=t.attribute_filters[a].filter(function(t){return t!==o})),0===t.attribute_filters[a].length&&delete t.attribute_filters[a]}else if(s.is(".field-filter")||s.is(".discount-filter")){var c=s.data(),d=c.filterName,l=c.filterValue;s.is(".discount-filter")&&delete t.field_filters.discount,r?(t.field_filters[d]=t.field_filters[d]||[],in_list(t.field_filters[d],l)||t.field_filters[d].push(l)):(t.field_filters[d]=t.field_filters[d]||[],t.field_filters[d]=t.field_filters[d].filter(function(t){return t!==l})),0===t.field_filters[d].length&&delete t.field_filters[d]}e.change_route_with_filters()})}change_route_with_filters(){var t=frappe.utils.get_query_params(),e=this.if_key_exists(t.start)||0;this.from_filters&&(e=0);var i=this.get_query_string({start:e,field_filters:JSON.stringify(this.if_key_exists(this.field_filters)),attribute_filters:JSON.stringify(this.if_key_exists(this.attribute_filters))});window.history.pushState("filters","",location.pathname+"?"+i),$(".page_content input").prop("disabled",!0),this.make(!0),$(".page_content input").prop("disabled",!1)}restore_filters_state(){var t=frappe.utils.get_query_params(),e=t.field_filters,i=t.attribute_filters;if(e){e=JSON.parse(e);var s=function(t){var i=e[t].map(function(e){return'input[data-filter-name="'+t+'"][data-filter-value="'+e+'"]'}).join(",");$(i).prop("checked",!0)};for(var r in e)s(r);this.field_filters=e}if(i){i=JSON.parse(i);var n=function(t){var e=i[t].map(function(e){return'input[data-attribute-name="'+t+'"][data-attribute-value="'+e+'"]'}).join(",");$(e).prop("checked",!0)};for(var a in i)n(a);this.attribute_filters=i}}render_no_products_section(t){void 0===t&&(t=!1);var e='\n\t\t\t<div class="cart-empty frappe-card mt-4">\n\t\t\t\t<div class="cart-empty-state">\n\t\t\t\t\t<img src="/assets/erpnext/images/ui-states/cart-empty-state.png" alt="Empty Cart">\n\t\t\t\t</div>\n\t\t\t\t<div class="cart-empty-message mt-4">'+__("No products found")+"</p>\n\t\t\t</div>\n\t\t";this.products_section.append(t?'\n\t\t\t<div class="mt-4 w-100 alert alert-error font-md">\n\t\t\t\tSomething went wrong. Please refresh or contact us.\n\t\t\t</div>\n\t\t':e)}render_item_sub_categories(t){if(t&&t.length){var e='\n\t\t\t\t<div class="sub-category-container scroll-categories">\n\t\t\t';t.forEach(function(t){e+='\n\t\t\t\t\t<a href="'+(t.route||"#")+'" style="text-decoration: none;">\n\t\t\t\t\t\t<div class="category-pill">\n\t\t\t\t\t\t\t'+t.name+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t"}),e+="</div>",$("#product-listing").prepend(e)}}get_query_string(t){var e=new URLSearchParams;for(var i in t){var s=t[i];s&&e.append(i,s)}return e.toString()}if_key_exists(t){var e=!1;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]){e=!0;break}return e?t:void 0}},erpnext.ProductGrid=class{constructor(t){Object.assign(this,t),"Grid View"!==this.preference&&this.products_section.addClass("hidden"),this.products_section.empty(),this.make()}make(){var t=this,e="";this.items.forEach(function(i){var s=i.web_item_name||i.item_name||i.item_code||"";s=s.length>90?s.substr(0,90)+"...":s,e+='<div class="col-sm-4 item-card"><div class="card text-left">',e+=t.get_image_html(i,s),e+=t.get_card_body_html(i,s,t.settings),e+="</div></div>"}),this.products_section.append(e)}get_image_html(t,e){var i=t.website_image||t.image;return i?'\n\t\t\t\t<div class="card-img-container">\n\t\t\t\t\t<a href="/'+(t.route||"#")+'" style="text-decoration: none;">\n\t\t\t\t\t\t<img class="card-img" src="'+i+'" alt="'+e+'">\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t':'\n\t\t\t\t<div class="card-img-container">\n\t\t\t\t\t<a href="/'+(t.route||"#")+'" style="text-decoration: none;">\n\t\t\t\t\t\t<div class="card-img-top no-image">\n\t\t\t\t\t\t\t'+frappe.get_abbr(e)+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t"}get_card_body_html(t,e,i){var s='\n\t\t\t<div class="card-body text-left card-body-flex" style="width:100%">\n\t\t\t\t<div style="margin-top: 1rem; display: flex;">\n\t\t';return s+=this.get_title(t,e),t.has_variants||(i.enable_wishlist&&(s+=this.get_wishlist_icon(t)),i.enabled&&(s+=this.get_cart_indicator(t))),s+="</div>",s+='<div class="product-category">'+(t.item_group||"")+"</div>",t.formatted_price&&(s+=this.get_price_html(t)),s+=this.get_stock_availability(t,i),s+=this.get_primary_button(t,i),s+="</div>"}get_title(t,e){return'\n\t\t\t<a href="/'+(t.route||"#")+'">\n\t\t\t\t<div class="product-title">\n\t\t\t\t\t'+(e||"")+"\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t"}get_wishlist_icon(t){var e=t.wished?"wished":"not-wished";return'\n\t\t\t<div class="like-action '+(t.wished?"like-action-wished":"")+'"\n\t\t\t\tdata-item-code="'+t.item_code+'">\n\t\t\t\t<svg class="icon sm">\n\t\t\t\t\t<use class="'+e+' wish-icon" href="#icon-heart"></use>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t'}get_cart_indicator(t){return'\n\t\t\t<div class="cart-indicator '+(t.in_cart?"":"hidden")+'" data-item-code="'+t.item_code+'">\n\t\t\t\t1\n\t\t\t</div>\n\t\t'}get_price_html(t){var e='\n\t\t\t<div class="product-price">\n\t\t\t\t'+(t.formatted_price||"")+"\n\t\t";return t.formatted_mrp&&(e+='\n\t\t\t\t<small class="striked-price">\n\t\t\t\t\t<s>'+(t.formatted_mrp?t.formatted_mrp.replace(/ +/g,""):"")+'</s>\n\t\t\t\t</small>\n\t\t\t\t<small class="ml-1 product-info-green">\n\t\t\t\t\t'+t.discount+" OFF\n\t\t\t\t</small>\n\t\t\t"),e+="</div>"}get_stock_availability(t,e){if(e.show_stock_availability&&!t.has_variants){if(t.on_backorder)return'\n\t\t\t\t\t<span class="out-of-stock mb-2 mt-1" style="color: var(--primary-color)">\n\t\t\t\t\t\t'+__("Available on backorder")+"\n\t\t\t\t\t</span>\n\t\t\t\t";if(!t.in_stock)return'\n\t\t\t\t\t<span class="out-of-stock mb-2 mt-1">\n\t\t\t\t\t\t'+__("Out of stock")+"\n\t\t\t\t\t</span>\n\t\t\t\t"}return""}get_primary_button(t,e){return t.has_variants?'\n\t\t\t\t<a href="/'+(t.route||"#")+'">\n\t\t\t\t\t<div class="btn btn-sm btn-explore-variants w-100 mt-4">\n\t\t\t\t\t\t'+__("Explore")+"\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t":e.enabled&&(e.allow_items_not_in_stock||t.in_stock)?'\n\t\t\t\t<div id="'+t.name+'" class="btn\n\t\t\t\t\tbtn-sm btn-primary btn-add-to-cart-list\n\t\t\t\t\tw-100 mt-2 '+(t.in_cart?"hidden":"")+'"\n\t\t\t\t\tdata-item-code="'+t.item_code+'">\n\t\t\t\t\t<span class="mr-2">\n\t\t\t\t\t\t<svg class="icon icon-md">\n\t\t\t\t\t\t\t<use href="#icon-assets"></use>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t'+(e.enable_checkout?__("Add to Cart"):__("Add to Quote"))+'\n\t\t\t\t</div>\n\n\t\t\t\t<a href="/cart">\n\t\t\t\t\t<div id="'+t.name+'" class="btn\n\t\t\t\t\t\tbtn-sm btn-primary btn-add-to-cart-list\n\t\t\t\t\t\tw-100 mt-4 go-to-cart-grid\n\t\t\t\t\t\t'+(t.in_cart?"":"hidden")+'"\n\t\t\t\t\t\tdata-item-code="'+t.item_code+'">\n\t\t\t\t\t\t'+(e.enable_checkout?__("Go to Cart"):__("Go to Quote"))+"\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t":""}},erpnext.ProductList=class{constructor(t){Object.assign(this,t),"List View"!==this.preference&&this.products_section.addClass("hidden"),this.products_section.empty(),this.make()}make(){var t=this,e="<br><br>";this.items.forEach(function(i){var s=i.web_item_name||i.item_name||i.item_code||"";s=s.length>200?s.substr(0,200)+"...":s,e+="<div class='row list-row w-100 mb-4'>",e+=t.get_image_html(i,s,t.settings),e+=t.get_row_body_html(i,s,t.settings),e+="</div>"}),this.products_section.append(e)}get_image_html(t,e,i){var s=t.website_image||t.image,r=!t.has_variants&&i.enable_wishlist,n="";return n+=s?'\n\t\t\t\t<div class="col-2 border text-center rounded list-image">\n\t\t\t\t\t<a class="product-link product-list-link" href="/'+(t.route||"#")+'">\n\t\t\t\t\t\t<img itemprop="image" class="website-image h-100 w-100" alt="'+e+'"\n\t\t\t\t\t\t\tsrc="'+s+'">\n\t\t\t\t\t</a>\n\t\t\t\t\t'+(r?this.get_wishlist_icon(t):"")+"\n\t\t\t\t</div>\n\t\t\t":'\n\t\t\t\t<div class="col-2 border text-center rounded list-image">\n\t\t\t\t\t<a class="product-link product-list-link" href="/'+(t.route||"#")+'"\n\t\t\t\t\t\tstyle="text-decoration: none">\n\t\t\t\t\t\t<div class="card-img-top no-image-list">\n\t\t\t\t\t\t\t'+frappe.get_abbr(e)+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</a>\n\t\t\t\t\t"+(r?this.get_wishlist_icon(t):"")+"\n\t\t\t\t</div>\n\t\t\t"}get_row_body_html(t,e,i){var s="<div class='col-10 text-left'>";return s+=this.get_title_html(t,e,i),s+=this.get_item_details(t,i),s+="</div>"}get_title_html(t,e,i){var s='<div style="display: flex; margin-left: -15px;">';return s+='\n\t\t\t<div class="col-8" style="margin-right: -15px;">\n\t\t\t\t<a class="" href="/'+(t.route||"#")+'"\n\t\t\t\t\tstyle="color: var(--gray-800); font-weight: 500;">\n\t\t\t\t\t'+e+"\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t",i.enabled&&(s+='<div class="col-4 cart-action-container '+(t.in_cart?"d-flex":"")+'">',s+=this.get_primary_button(t,i),s+="</div>"),s+="</div>"}get_item_details(t,e){var i='\n\t\t\t<p class="product-code">\n\t\t\t\t'+t.item_group+" | Item Code : "+t.item_code+'\n\t\t\t</p>\n\t\t\t<div class="mt-2" style="color: var(--gray-600) !important; font-size: 13px;">\n\t\t\t\t'+(t.short_description||"")+'\n\t\t\t</div>\n\t\t\t<div class="product-price">\n\t\t\t\t'+(t.formatted_price||"")+"\n\t\t";return t.formatted_mrp&&(i+='\n\t\t\t\t<small class="striked-price">\n\t\t\t\t\t<s>'+(t.formatted_mrp?t.formatted_mrp.replace(/ +/g,""):"")+'</s>\n\t\t\t\t</small>\n\t\t\t\t<small class="ml-1 product-info-green">\n\t\t\t\t\t'+t.discount+" OFF\n\t\t\t\t</small>\n\t\t\t"),i+=this.get_stock_availability(t,e),i+="</div>"}get_stock_availability(t,e){if(e.show_stock_availability&&!t.has_variants){if(t.on_backorder)return'\n\t\t\t\t\t<br>\n\t\t\t\t\t<span class="out-of-stock mt-2" style="color: var(--primary-color)">\n\t\t\t\t\t\t'+__("Available on backorder")+"\n\t\t\t\t\t</span>\n\t\t\t\t";if(!t.in_stock)return'\n\t\t\t\t\t<br>\n\t\t\t\t\t<span class="out-of-stock mt-2">'+__("Out of stock")+"</span>\n\t\t\t\t"}return""}get_wishlist_icon(t){var e=t.wished?"wished":"not-wished";return'\n\t\t\t<div class="like-action-list '+(t.wished?"like-action-wished":"")+'"\n\t\t\t\tdata-item-code="'+t.item_code+'">\n\t\t\t\t<svg class="icon sm">\n\t\t\t\t\t<use class="'+e+' wish-icon" href="#icon-heart"></use>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t'}get_primary_button(t,e){return t.has_variants?'\n\t\t\t\t<a href="/'+(t.route||"#")+'">\n\t\t\t\t\t<div class="btn btn-sm btn-explore-variants btn mb-0 mt-0">\n\t\t\t\t\t\t'+__("Explore")+"\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t":e.enabled&&(e.allow_items_not_in_stock||t.in_stock)?'\n\t\t\t\t<div id="'+t.name+'" class="btn\n\t\t\t\t\tbtn-sm btn-primary btn-add-to-cart-list mb-0\n\t\t\t\t\t'+(t.in_cart?"hidden":"")+'"\n\t\t\t\t\tdata-item-code="'+t.item_code+'"\n\t\t\t\t\tstyle="margin-top: 0px !important; max-height: 30px; float: right;\n\t\t\t\t\t\tpadding: 0.25rem 1rem; min-width: 135px;">\n\t\t\t\t\t<span class="mr-2">\n\t\t\t\t\t\t<svg class="icon icon-md">\n\t\t\t\t\t\t\t<use href="#icon-assets"></use>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t'+(e.enable_checkout?__("Add to Cart"):__("Add to Quote"))+'\n\t\t\t\t</div>\n\n\t\t\t\t<div class="cart-indicator list-indicator '+(t.in_cart?"":"hidden")+'">\n\t\t\t\t\t1\n\t\t\t\t</div>\n\n\t\t\t\t<a href="/cart">\n\t\t\t\t\t<div id="'+t.name+'" class="btn\n\t\t\t\t\t\tbtn-sm btn-primary btn-add-to-cart-list\n\t\t\t\t\t\tml-4 go-to-cart mb-0 mt-0\n\t\t\t\t\t\t'+(t.in_cart?"":"hidden")+'"\n\t\t\t\t\t\tdata-item-code="'+t.item_code+'"\n\t\t\t\t\t\tstyle="padding: 0.25rem 1rem; min-width: 135px;">\n\t\t\t\t\t\t'+(e.enable_checkout?__("Go to Cart"):__("Go to Quote"))+"\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t":""}},erpnext.ProductSearch=class{constructor(){this.MAX_RECENT_SEARCHES=4,this.searchBox=$("#search-box"),this.setupSearchDropDown(),this.bindSearchAction()}setupSearchDropDown(){this.search_area=$("#dropdownMenuSearch"),this.setupSearchResultContainer(),this.populateRecentSearches()}bindSearchAction(){var t=this,e=this;this.searchBox.on("focus",function(){t.search_dropdown.removeClass("hidden")}),$("body").on("click",function(e){var i=$(e.target).closest("#search-box").length,s=$(e.target).closest("#search-results-container").length,r=t.search_dropdown.hasClass("hidden");i||s||r||t.search_dropdown.addClass("hidden")}),this.searchBox.on("input",function(i){var s=i.target.value;0==s.length&&(e.populateResults(null),e.populateCategoriesList(null)),s.length<3||!s.length||(frappe.call({method:"erpnext.templates.pages.product_search.search",args:{query:s},callback:function(t){var i,r=null;i=t.message?t.message.product_results:null,e.populateResults(i),e.category_container&&(r=t.message?t.message.category_results:null,e.populateCategoriesList(r)),$.isEmptyObject(i)&&$.isEmptyObject(r)||e.setRecentSearches(s)}}),t.search_dropdown.removeClass("hidden"))})}setupSearchResultContainer(){this.search_dropdown=this.search_area.append('\n\t\t\t<div class="overflow-hidden shadow dropdown-menu w-100 hidden"\n\t\t\t\tid="search-results-container"\n\t\t\t\taria-labelledby="dropdownMenuSearch"\n\t\t\t\tstyle="display: flex; flex-direction: column;">\n\t\t\t</div>\n\t\t').find("#search-results-container"),this.setupCategoryContainer(),this.setupProductsContainer(),this.setupRecentsContainer()}setupProductsContainer(){this.products_container=this.search_dropdown.append('\n\t\t\t<div id="product-results mt-2">\n\t\t\t\t<div id="product-scroll" style="overflow: scroll; max-height: 300px">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t').find("#product-scroll")}setupCategoryContainer(){this.category_container=this.search_dropdown.append('\n\t\t\t<div class="category-container mt-2 mb-1">\n\t\t\t\t<div class="category-chips">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t').find(".category-chips")}setupRecentsContainer(){var t=this.search_dropdown.append('\n\t\t\t<div class="mb-2 mt-2 recent-searches">\n\t\t\t\t<div>\n\t\t\t\t\t<b>'+__("Recent")+"</b>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t").find(".recent-searches");this.recents_container=t.append('\n\t\t\t<div id="recents" style="padding: .25rem 0 1rem 0;">\n\t\t\t</div>\n\t\t').find("#recents")}getRecentSearches(){return JSON.parse(localStorage.getItem("recent_searches")||"[]")}attachEventListenersToChips(){var t=this,e=$(".recent-search");window.chips=e;for(var i=function(){var e=r[s];e.addEventListener("click",function(){t.searchBox[0].value=e.innerText.trim(),t.searchBox.trigger("input"),t.searchBox.focus()})},s=0,r=e;s<r.length;s+=1)i()}setRecentSearches(t){var e=this.getRecentSearches();e.length>=this.MAX_RECENT_SEARCHES&&e.splice(0,1),e.indexOf(t)>=0||(e.push(t),localStorage.setItem("recent_searches",JSON.stringify(e)),this.populateRecentSearches())}populateRecentSearches(){var t=this.getRecentSearches();if(t.length){var e="";t.forEach(function(t){e+='\n\t\t\t\t<div class="recent-search mr-1" style="font-size: 13px">\n\t\t\t\t\t<span class="mr-2">\n\t\t\t\t\t\t<svg width="20" height="20" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t\t\t\t\t\t\t<path d="M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14Z" stroke="var(--gray-500)"" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t\t<path d="M8.00027 5.20947V8.00017L10 10" stroke="var(--gray-500)" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</span>\n\t\t\t\t\t'+t+"\n\t\t\t\t</div>\n\t\t\t"}),this.recents_container.html(e),this.attachEventListenersToChips()}else this.recents_container.html('<span class=""text-muted">No searches yet.</span>')}populateResults(t){if(t&&0!==t.length){var e="";t.forEach(function(t){var i=t.thumbnail||"/assets/erpnext/images/ui-states/cart-empty-state.png";e+='\n\t\t\t\t<div class="dropdown-item" style="display: flex;">\n\t\t\t\t\t<img class="item-thumb col-2" src='+i+' />\n\t\t\t\t\t<div class="col-9" style="white-space: normal;">\n\t\t\t\t\t\t<a href="/'+t.route+'">'+t.web_item_name+'</a><br>\n\t\t\t\t\t\t<span class="brand-line">'+(t.brand?"by "+t.brand:"")+"</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t"}),this.products_container.html(e)}else{this.products_container.html("")}}populateCategoriesList(t){if(t&&0!==t.length){var e='\n\t\t\t<div class="mb-2">\n\t\t\t\t<b>'+__("Categories")+"</b>\n\t\t\t</div>\n\t\t";t.forEach(function(t){e+='\n\t\t\t\t<a href="/'+t.route+'" class="btn btn-sm category-chip mr-2 mb-2"\n\t\t\t\t\tstyle="font-size: 13px" role="button">\n\t\t\t\t'+t.name+"\n\t\t\t\t</button>\n\t\t\t"}),this.category_container.html(e)}else{this.category_container.html('\n\t\t\t\t<div class="category-container mt-2">\n\t\t\t\t\t<div class="category-chips">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t')}}}}();
//# sourceMappingURL=e-commerce.min.js.map
